DROP TABLE CONCIERTO CASCADE CONSTRAINTS;

DROP TABLE GRUPO CASCADE CONSTRAINTS;

DROP TABLE CLIENTE CASCADE CONSTRAINTS;

DROP TABLE COMPRA CASCADE CONSTRAINTS;


CREATE TABLE CLIENTE (
	NIF VARCHAR(10) PRIMARY KEY,
	NOMBRE VARCHAR(50) NOT NULL,
	APELLIDOS VARCHAR(100) NOT NULL,
	DIRECCION VARCHAR(100),
  	CP VARCHAR(5),
 	CIUDAD VARCHAR(20)
);

CREATE TABLE GRUPO (
	IDGRUPO INTEGER PRIMARY KEY,
	NOMBRE VARCHAR(50) NOT NULL,
	ESTILO VARCHAR(20),
	ACTIVO INTEGER NOT NULL
);

CREATE TABLE CONCIERTO (
	IDCONCIERTO INTEGER PRIMARY KEY,
	NOMBRE VARCHAR(100) NOT NULL,
	CIUDAD VARCHAR(100) NOT NULL,
	FECHA TIMESTAMP NOT NULL,
	TICKETS INTEGER NOT NULL,
	PRECIO FLOAT NOT NULL,
	IDGRUPO INTEGER NOT NULL,
	FOREIGN KEY (IDGRUPO) REFERENCES GRUPO(IDGRUPO) 
);


CREATE TABLE COMPRA (
	IDCOMPRA INTEGER PRIMARY KEY,
	NIF VARCHAR(10) NOT NULL,
	IDCONCIERTO INTEGER NOT NULL,
	N_TICKETS INTEGER NOT NULL,
	FOREIGN KEY (NIF) REFERENCES CLIENTE(NIF),
	FOREIGN KEY (IDCONCIERTO) REFERENCES CONCIERTO (IDCONCIERTO)
);

INSERT INTO CLIENTE VALUES ('1111111F', 'Luis', 'Rodriguez Garcia', 'C/Mayor 5', '9999', 'Palencia');
INSERT INTO CLIENTE VALUES ('7352353T', 'Luis', 'Rodriguez Garcia', 'C/Hueso Roto 15', '9999', 'Palencia');
INSERT INTO CLIENTE VALUES ('7666832Y', 'Luis', 'Rodriguez Garcia', 'C/Atlantico 12', '3333', 'Burgos');

INSERT INTO GRUPO VALUES (1, 'Los Burning', 'Rock', '1');
INSERT INTO GRUPO VALUES (2, 'Laura Mancini', 'Romantico', '1');


INSERT INTO CONCIERTO VALUES (1, 'Rock Tardio', 'Madrid', TO_TIMESTAMP('01-11-2023 21:00:00', 'DD-MM-YYYY HH24:MI:SS'), 100, 25.5, 1);
INSERT INTO CONCIERTO VALUES (2, 'Gira Balada', 'Madrid', TO_TIMESTAMP('01-11-2023 22:00:00', 'DD-MM-YYYY HH24:MI:SS'), 100, 35, 2);
INSERT INTO CONCIERTO VALUES (3, 'Gira Balada', 'Madrid', TO_TIMESTAMP('15-11-2023 22:30:00', 'DD-MM-YYYY HH24:MI:SS'), 100, 27.5, 2);

INSERT INTO COMPRA VALUES (1, '1111111F', 2, 5);
INSERT INTO COMPRA VALUES (2, '7352353T', 3, 10);
INSERT INTO COMPRA VALUES (3, '7666832Y', 1,  3);
INSERT INTO COMPRA VALUES (4, '7352353T', 1, 3);
INSERT INTO COMPRA VALUES (5, '1111111F', 1, 10);


COMMIT;
EXIT
